<!-- templates/index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PDF Keyword Finder</title>
    <style>
        body { font-family: Arial; margin: 20px; }
        .keyword-box { display: none; margin-bottom: 20px; }
        .snippet { background-color: #f4f4f4; padding: 10px; margin-bottom: 10px; }
        .highlight { background-color: yellow; font-weight: bold; }
    </style>
    <script>
        function toggleKeywords() {
            const box = document.getElementById('keyword-box');
            box.style.display = box.style.display === 'none' ? 'block' : 'none';
        }
    </script>
</head>
<body>
    <h1>PDF Keyword Finder</h1>
    <form method="POST" enctype="multipart/form-data">
        <input type="file" name="pdf" accept="application/pdf" required>
        <button type="submit">Upload PDF</button>
    </form>

    <button onclick="toggleKeywords()">ADD Keywords</button>
    <div id="keyword-box" class="keyword-box">
        <form method="POST" action="/add_keyword">
            <input type="text" name="keyword" placeholder="Keyword" required>
            <select name="type">
                <option value="positive">Positive</option>
                <option value="negative">Negative</option>
            </select>
            <button type="submit">Add</button>
        </form>

        <h3>Positive Keywords</h3>
        <ul>
            {% for kw in pos_keywords %}
            <li>{{ kw }}
                <form action="/delete_keyword/{{ kw }}" method="POST" style="display:inline">
                    <input type="password" name="password" placeholder="Password" required>
                    <button type="submit">üóëÔ∏è</button>
                </form>
            </li>
            {% endfor %}
        </ul>

        <h3>Negative Keywords</h3>
        <ul>
            {% for kw in neg_keywords %}
            <li>{{ kw }}
                <form action="/delete_keyword/{{ kw }}" method="POST" style="display:inline">
                    <input type="password" name="password" placeholder="Password" required>
                    <button type="submit">üóëÔ∏è</button>
                </form>
            </li>
            {% endfor %}
        </ul>
    </div>

    {% if results %}
        <h2>Keyword Summary</h2>
        <p><strong>Positive:</strong> 
            {% for k, v in pos_counts.items() if v > 0 %}
                {{ k }}({{ v }}){% if not loop.last %}, {% endif %}
            {% endfor %}
        </p>
        <p><strong>Negative:</strong> 
            {% for k, v in neg_counts.items() if v > 0 %}
                {{ k }}({{ v }}){% if not loop.last %}, {% endif %}
            {% endfor %}
        </p>

        <h2>Results</h2>
        {% for result in results %}
            <div class="snippet">
                <strong>Page {{ result.page }}</strong><br>
                <strong>Positive:</strong> {{ result.found_positive | join(', ') }}<br>
                <strong>Negative:</strong> {{ result.found_negative | join(', ') }}<br>
                <p>{{ result.snippet }}</p>
            </div>
        {% endfor %}
    {% endif %}

    {% with messages = get_flashed_messages() %}
      {% if messages %}
        <ul>
        {% for message in messages %}
          <li>{{ message }}</li>
        {% endfor %}
        </ul>
      {% endif %}
    {% endwith %}
</body>
</html>
