<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PDF Keyword Search</title>
</head>
<body>
    <h2>This is for cross-reference purposes only and should not be used as the sole basis for your review.</h2>

    <h1>Upload PDF</h1>
    <form method="POST" enctype="multipart/form-data">
        <input type="file" name="pdf" accept=".pdf" required><br><br>

        <label>Positive Keywords (comma-separated):</label><br>
        <input type="text" name="positive_keywords"><br><br>

        <label>Negative Keywords (comma-separated):</label><br>
        <input type="text" name="negative_keywords"><br><br>

        <input type="submit" value="Upload & Scan">
    </form>

    <h2>Saved Positive Keywords</h2>
    <ul>
        {% for k in pos_keywords %}
        <li>
            <form method="POST" action="{{ url_for('edit', keyword_id=k[0]) }}" style="display:inline;">
                <input type="text" name="new_word" value="{{ k[1] }}">
                <button type="submit">Edit</button>
            </form>
            <form method="POST" action="{{ url_for('delete', keyword_id=k[0]) }}" style="display:inline;">
                <button type="submit">Delete</button>
            </form>
        </li>
        {% endfor %}
    </ul>

    <h2>Saved Negative Keywords</h2>
    <ul>
        {% for k in neg_keywords %}
        <li>
            <form method="POST" action="{{ url_for('edit', keyword_id=k[0]) }}" style="display:inline;">
                <input type="text" name="new_word" value="{{ k[1] }}">
                <button type="submit">Edit</button>
            </form>
            <form method="POST" action="{{ url_for('delete', keyword_id=k[0]) }}" style="display:inline;">
                <button type="submit">Delete</button>
            </form>
        </li>
        {% endfor %}
    </ul>

    {% if results %}
        <h2>Keyword Matches</h2>
        {% for page in results %}
            <h3>Page {{ page.page }}</h3>
            <ul>
                {% for word, count in page.matches %}
                    <li>{{ word }}: {{ count }} matches</li>
                {% endfor %}
            </ul>
        {% endfor %}

        <h2>Total Keyword Counts</h2>
        <ul>
        {% for word, count in counts.items() %}
            <li>{{ word }}: {{ count }}</li>
        {% endfor %}
        </ul>

        {% if highlighted_pdf %}
        <p><a href="{{ url_for('download_highlighted', filename=highlighted_pdf.split('/')[-1]) }}" target="_blank">Download Highlighted PDF</a></p>
        {% endif %}
    {% endif %}
</body>
</html>
