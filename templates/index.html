<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PDF Keyword Search</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 30px; }
        .highlight-positive { background-color: #d4edda; }
        .highlight-negative { background-color: #f8d7da; }
        .keyword { margin: 5px 0; }
        .icon-btn { border: none; background: none; cursor: pointer; color: red; }
    </style>
</head>
<body>
    <h3>This is for cross-reference purposes only and should not be used as the sole basis for your review.</h3>

    <h2>Upload PDF to Search Keywords</h2>
    <form action="/search_pdf" method="post" enctype="multipart/form-data">
        <input type="file" name="pdf" required>
        <button type="submit">Search PDF</button>
    </form>

    <hr>

    <h2>Add Keyword</h2>
    <form action="/add_keyword" method="post">
        <input type="text" name="keyword" placeholder="Enter keyword" required>
        <select name="keyword_type">
            <option value="positive">Positive</option>
            <option value="negative">Negative</option>
        </select>
        <button type="submit">Add</button>
    </form>

    <hr>

    <details open>
        <summary><strong>Saved Positive Keywords</strong></summary>
        <ul>
            {% for id, word in pos_keywords %}
                <li class="keyword highlight-positive">
                    {{ word }}
                    <form action="/delete_keyword/{{ id }}" method="post" style="display:inline;" onsubmit="return confirm('Delete this keyword?');">
                        <button class="icon-btn" title="Delete">üóëÔ∏è</button>
                    </form>
                    <form action="/edit_keyword/{{ id }}" method="post" style="display:inline;">
                        <input type="text" name="new_word" placeholder="Edit" required>
                        <button class="icon-btn" title="Edit">‚úèÔ∏è</button>
                    </form>
                </li>
            {% endfor %}
        </ul>
    </details>

    <details>
        <summary><strong>Saved Negative Keywords</strong></summary>
        <ul>
            {% for id, word in neg_keywords %}
                <li class="keyword highlight-negative">
                    {{ word }}
                    <form action="/delete_keyword/{{ id }}" method="post" style="display:inline;" onsubmit="return confirm('Delete this keyword?');">
                        <button class="icon-btn" title="Delete">üóëÔ∏è</button>
                    </form>
                    <form action="/edit_keyword/{{ id }}" method="post" style="display:inline;">
                        <input type="text" name="new_word" placeholder="Edit" required>
                        <button class="icon-btn" title="Edit">‚úèÔ∏è</button>
                    </form>
                </li>
            {% endfor %}
        </ul>
    </details>

    {% if results %}
    <hr>
    <h2>Matched Results</h2>
    <ul>
        {% for item in results %}
            <li><strong>Page {{ item.page }}</strong>
                <ul>
                    {% for match in item.matches %}
                        <li class="{{ 'highlight-positive' if match.type == 'positive' else 'highlight-negative' }}">
                            <strong>{{ match.keyword }}</strong> ‚Äî {{ match.count }} match{{ 'es' if match.count > 1 else '' }}
                            <ul>
                                {% for snippet in match.snippets %}
                                   <li>... {{ snippet }} ...</li>
                                {% endfor %}
                           </ul>
                        </li>
                    {% endfor %}
                </ul>
            </li>
        {% endfor %}
    </ul>
    {% endif %}
</body>
</html>
