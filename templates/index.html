<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PDF Keyword Search</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        textarea { width: 100%; height: 200px; margin-top: 10px; }
        .keyword-group { margin-bottom: 10px; }
        .keyword { display: inline-block; background: #f2f2f2; padding: 5px 10px; margin: 3px; border-radius: 5px; }
        .matched-line { background: #ffffcc; padding: 5px; margin-bottom: 3px; border-left: 4px solid orange; }
        .icon-btn { background: none; border: none; cursor: pointer; margin-left: 5px; color: red; }
    </style>
    <script>
        function confirmDelete(form) {
            if (confirm("Are you sure you want to delete this keyword?")) {
                form.submit();
            }
        }
        function showEditForm(id, oldValue) {
            const container = document.getElementById(`keyword-container-${id}`);
            container.innerHTML = `
                <form method="POST" action="/edit_keyword/${id}" style="display:inline;">
                    <input name="new_word" value="${oldValue}" required>
                    <button type="submit">Save</button>
                </form>`;
        }
    </script>
</head>
<body>
    <h1>PDF Keyword Search</h1>

    {% if message %}
        <p><strong>{{ message }}</strong></p>
    {% endif %}

    <h2>Upload PDF</h2>
    <form method="POST" enctype="multipart/form-data" action="/">
        <input type="file" name="pdf_file" accept=".pdf" required>
        <button type="submit">Search PDF</button>
    </form>

    <h2>Positive Keywords</h2>
    <div class="keyword-group">
        {% for id, word in pos_keywords %}
            <span class="keyword" id="keyword-container-{{ id }}">
                {{ word }}
                <button class="icon-btn" onclick="showEditForm({{ id }}, '{{ word }}')">‚úèÔ∏è</button>
                <form method="POST" action="/delete_keyword/{{ id }}" style="display:inline;">
                    <button class="icon-btn" type="button" onclick="confirmDelete(this.form)">üóëÔ∏è</button>
                </form>
            </span>
        {% endfor %}
    </div>

    <form method="POST" action="/add_keyword">
        <input name="word" placeholder="Add keyword" required>
        <input type="hidden" name="type" value="positive">
        <button type="submit">Add Positive</button>
    </form>

    <h2>Negative Keywords</h2>
    <div class="keyword-group">
        {% for id, word in neg_keywords %}
            <span class="keyword" id="keyword-container-{{ id }}">
                {{ word }}
                <button class="icon-btn" onclick="showEditForm({{ id }}, '{{ word }}')">‚úèÔ∏è</button>
                <form method="POST" action="/delete_keyword/{{ id }}" style="display:inline;">
                    <button class="icon-btn" type="button" onclick="confirmDelete(this.form)">üóëÔ∏è</button>
                </form>
            </span>
        {% endfor %}
    </div>

    <form method="POST" action="/add_keyword">
        <input name="word" placeholder="Add keyword" required>
        <input type="hidden" name="type" value="negative">
        <button type="submit">Add Negative</button>
    </form>

    {% if matched_lines %}
        <h2>Matched Text</h2>
        <div>
            {% for line in matched_lines %}
                <div class="matched-line">{{ line }}</div>
            {% endfor %}
        </div>
    {% endif %}

    {% if extracted_text %}
        <h2>Full PDF Text</h2>
        <textarea readonly>{{ extracted_text }}</textarea>
    {% endif %}
</body>
</html>
