<!DOCTYPE html>
<html>
<head>
    <title>PDF Keyword Search</title>
</head>
<body>
    <h2>Upload a PDF & Search Keywords</h2>
    <form method="post" enctype="multipart/form-data">
        <label>PDF File:</label>
        <input type="file" name="pdf" required><br><br>

        <label>Keywords (comma-separated):</label>
        <input type="text" name="keywords" required><br><br>

        <button type="submit">Search</button>
    </form>

    <hr>

    {% if results %}
        <h3>Search Results:</h3>
        <ul>
            {% for result in results %}
                <li>
                    <strong>Page {{ result.page }}:</strong><br>
                    <em>Matched Line:</em> {{ result.line }}<br>
                    <em>Matched Keywords:</em> {{ result.keywords | join(", ") }}
                </li>
            {% endfor %}
        </ul>
    {% elif request.method == 'POST' %}
        <p><strong>No matches found.</strong></p>
    {% endif %}

    {% if previous_keywords %}
    <hr>
    <h3>Previously Searched Keywords:</h3>
    <ul>
        {% for kw in previous_keywords %}
            <li>{{ kw }}</li>
        {% endfor %}
    </ul>
{% endif %}

<form method="POST" enctype="multipart/form-data">
  <label>Upload PDF:</label>
  <input type="file" name="pdf_file" required><br><br>

  <label>Enter keywords (comma separated):</label>
  <input type="text" name="keywords" id="keywordsInput" required><br><br>

  <button type="submit">Search</button>
</form>

<h3>Previous Keywords:</h3>
{% for keyword in previous_keywords %}
  <button type="button" onclick="addKeyword('{{ keyword }}')">{{ keyword }}</button>
{% endfor %}

<script>
  function addKeyword(keyword) {
    const input = document.getElementById("keywordsInput");
    let current = input.value.split(",").map(k => k.trim()).filter(k => k !== "");
    if (!current.includes(keyword)) {
      current.push(keyword);
      input.value = current.join(", ");
    }
  }
</script>

</body>
</html>
